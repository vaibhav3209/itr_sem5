{% extends 'final/base_layout.html' %}

{% load static %}

{% block extra_css_files %}
<link rel="stylesheet" href="{% static 'final/css/student_dashboard.css' %}">
<link rel="stylesheet" href="{% static 'final/css/sidebar.css' %}">
<link rel="stylesheet" href="{% static 'final/css/main_content.css' %}">
<link rel="stylesheet" href="{% static 'final/css/table.css' %}">
{% endblock %}

{% block page_title %}Components Items{% endblock %}

{% block extra_js_files %}
<script src="{% static 'final/js/listcomponent_bycategory.js' %}"></script>
<script src="{% static 'final/js/filter_components.js' %}"></script>
{% endblock %}

{% block page_content %}
    <div class="dashboard-container">

      <aside class="sidebar">
          <h2>IoT Lab</h2>
          <ul>
              <li><a href="{% url 'final:student_dashboard' %}">Back to dashboard</a></li>
            <li><a href="{% url 'final:issued_items' %}">Issued Items</a></li>
            <li><a href="{% url 'final:request_components' %}">Request Components</a></li>
                <li>
                    <form method="post" action="{% url 'final:student_logout' %}"
                          style="display:inline;">
                            {% csrf_token %}
                        <button type="submit" class="as-link">Logout</button>
                    </form>
                </li>
          </ul>
        </aside>

      <main class="main-content">
        <section>

<!--search bar-->
          <div class="search-bar">
            <input type="text" id="searchInput" placeholder="Search component..." onkeyup="filterComponents()">
          </div>

        <div class="category-block">
          {% if components %}
          <table>
            <thead>
              <tr>
                <th>{{ category_name }}</th>
                <th>Available</th>
                <th>Action</th>
              </tr>
            </thead>

            <tbody>
              {% for item in components %}
              <tr  data-name="{{ item.comp_name }}">
                <td>{{ item.comp_name }}</td>
                <td>{{ item.comp_quantity_available }}</td>
                <td>
          <div id="control-{{ item.id }}">
            {% if item.comp_quantity_available > 0 %}
               <button onclick="startQuantityControl({{ item.id }}, {{ item.comp_quantity_available }}, '{{ item.comp_name|escapejs }}')">Add</button>
            {% else %}
              <button disabled>Out of Stock</button>
            {% endif %}
          </div>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
</div>
          {% else %}
            <p class="empty">No components available.</p>
          {% endif %}

        </section>
      </main>
    </div>
{% endblock %}


