{% extends 'base_layout.html' %}

{% load static %}

{% block extra_css_files %}<link rel="stylesheet" href="{% static 'final/css/issued_items.css' %}">{% endblock %}

{% block page_title %}Student Isssued Items{% endblock %}

{% block page_content %}
<div class="dashboard-container">
<aside class="sidebar">
      <h2>IoT Lab</h2>
      <ul>
        <li><a href="{% url 'final:student_dashboard'  %}"> back to Dashboard</a></li>
        <li><a href="{% url 'final:student_logout' %}">Logout</a></li>
      </ul>
</aside>

    <main class="main-content">
<div class="container">
    <h2>Issued Items</h2>

    <!-- Current Issued Items -->
    <section>
        <h3 class="section-title">ðŸ“Œ Currently Issued Components</h3>
        {% if grouped_current %}
            {% for category, items in grouped_current.items %}
                <div class="category-block">
                    <h4>{{ category }}</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Component</th>
                                <th>Quantity</th>
                                <th>Form Date</th>
                                <th>Issue Date</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for i in items %}
                            <tr>
                                <td>{{ i.component.comp_name }}</td>
                                <td>{{ i.std_issue_quantity_issued }}</td>
                                <td>{{ i.std_issue_form_date }}</td>
                                <td>{{ i.std_issue_issue_date }}</td>
                                <td class="status {{ i.std_issue_status_from_student|lower }}">{{ i.std_issue_status_from_student }}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% endfor %}
        {% else %}
            <p class="empty">No current issues.</p>
        {% endif %}
    </section>

    <!-- Previously Issued Items -->
    <section>
        <h3 class="section-title">ðŸ“¦ Previously Issued (Returned) Components</h3>
        {% if grouped_previous %}
            {% for category, items in grouped_previous.items %}
                <div class="category-block">
                    <h4>{{ category }}</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Component</th>
                                <th>Quantity</th>
                                <th>Form Date</th>
                                <th>Issue Date</th>
                                <th>Return Date</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for i in items %}
                            <tr>
                                <td>{{ i.component.comp_name }}</td>
                                <td>{{ i.std_issue_quantity_issued }}</td>
                                <td>{{ i.std_issue_form_date }}</td>
                                <td>{{ i.std_issue_issue_date }}</td>
                                <td>{{ i.std_issue_return_date }}</td>
                                <td class="status {{ i.std_issue_status_from_student|lower }}">{{ i.std_issue_status_from_student }}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% endfor %}
        {% else %}
            <p class="empty">No previous issues.</p>
        {% endif %}
    </section>
</div>
    </main>
</div>
{% endblock %}
